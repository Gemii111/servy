# ğŸ“ Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Order Tracking System)

## ğŸ”„ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ

### 1. **Ù…Ù† Ù†Ø§Ø­ÙŠØ© Ø§Ù„Ø³Ø§Ø¦Ù‚ (Driver Side)**

#### Ø£. ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Location Tracking)
- Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ°Ù‡Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ **Online** â†’ ÙŠØ¨Ø¯Ø£ ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- ÙŠØ³ØªØ®Ø¯Ù… `DriverLocationService` Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† GPS
- ÙŠØ³ØªØ®Ø¯Ù… `DriverLocationUpdateService` Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ù€ Backend

#### Ø¨. Ø¢Ù„ÙŠØ© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (Update Mechanism)
```dart
// ÙŠØ±Ø³Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒÙ„ 50 Ù…ØªØ± (distance-based)
static const double _minDistanceToSend = 50.0; // meters
```

**Ù…ØªÙ‰ ÙŠØ±Ø³Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ**
- âœ… Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªØ­Ø±Ùƒ Ø§Ù„Ø³Ø§Ø¦Ù‚ **Ø£ÙƒØ«Ø± Ù…Ù† 50 Ù…ØªØ±**
- âœ… ÙŠØ±Ø³Ù„: `latitude`, `longitude`, `heading`, `speed`, `timestamp`
- âœ… ÙŠØªÙ… Ø­ÙØ¸Ù‡ ÙÙŠ `driver_locations` table ÙÙŠ Ø§Ù„Ù€ Database

**Ù…Ù…ÙŠØ²Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù…:**
- âœ… Ù…ÙˆÙØ± Ù„Ù„Ù€ Battery (Ù„Ø§ ÙŠØ±Ø³Ù„ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©)
- âœ… Ù…ÙˆÙØ± Ù„Ù„Ù€ Data (ÙŠØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø±ÙƒØ©)
- âœ… Ø¯Ù‚ÙŠÙ‚ (ÙŠØ±Ø³Ù„ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø´ÙƒÙ„ Ù…Ù„Ø­ÙˆØ¸)

---

### 2. **Ù…Ù† Ù†Ø§Ø­ÙŠØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ (Customer Side)**

#### Ø£. Ø¬Ù„Ø¨ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ (Fetching Driver Location)
- Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙØªØ­ ØµÙØ­Ø© **Order Tracking**
- ÙŠØ³ØªØ®Ø¯Ù… `driverLocationForOrderProvider` Ù„Ø¬Ù„Ø¨ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚

#### Ø¨. Ø¢Ù„ÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ« (Update Mechanism)
```dart
// Polling ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
Stream.periodic(const Duration(seconds: 10))
```

**ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ**
1. ÙƒÙ„ **10 Ø«ÙˆØ§Ù†ÙŠ** â†’ ÙŠØ·Ù„Ø¨ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù…Ù† Ø§Ù„Ù€ Backend
2. Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªØ­Ø¯ÙŠØ« â†’ ÙŠØ¹Ø±Ø¶Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
3. ÙŠØ­Ø¯Ø« Ø§Ù„Ù€ Marker Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

**Ù„Ù…Ø§Ø°Ø§ 10 Ø«ÙˆØ§Ù†ÙŠØŸ**
- âœ… **Ù…ÙˆÙØ± Ù„Ù„Ù€ Battery**: Ø£Ù‚Ù„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ù…Ù† 3 Ø«ÙˆØ§Ù†ÙŠ
- âœ… **Ù…ÙˆÙØ± Ù„Ù„Ù€ Data**: Ø£Ù‚Ù„ Ø·Ù„Ø¨Ø§Øª Ù„Ù„Ù€ API
- âœ… **Ø¬ÙŠØ¯ Ù„Ù„Ù€ UX**: 10 Ø«ÙˆØ§Ù†ÙŠ ÙƒØ§ÙÙŠØ© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯
- âœ… **Ø£Ù‚Ù„ Ø­Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù€ Server**: Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ø·Ù„Ø¨Ø§Øª

---

## ğŸ“Š Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„ÙƒØ§Ù…Ù„ (Complete Flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ø§Ù„Ø³Ø§Ø¦Ù‚ (Driver)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 1. ÙŠØ°Ù‡Ø¨ Online
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ DriverLocation    â”‚
                    â”‚ Service           â”‚
                    â”‚ (GPS Tracking)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 2. ÙƒÙ„ 50 Ù…ØªØ±
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ DriverLocation    â”‚
                    â”‚ UpdateService     â”‚
                    â”‚ (Send to Backend) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 3. HTTP POST
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Backend Server                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  driver_locations Table                               â”‚  â”‚
â”‚  â”‚  - driver_id                                         â”‚  â”‚
â”‚  â”‚  - latitude, longitude                               â”‚  â”‚
â”‚  â”‚  - timestamp                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ 4. GET Request
                            â”‚    (ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ø§Ù„Ø¹Ù…ÙŠÙ„ (Customer)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Order Tracking Screen                               â”‚  â”‚
â”‚  â”‚  - driverLocationForOrderProvider                    â”‚  â”‚
â”‚  â”‚  - Stream.periodic(10 seconds)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                â”‚
â”‚                            â”‚ 5. Update Map                 â”‚
â”‚                            â–¼                                â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                    â”‚  Google Maps      â”‚                    â”‚
â”‚                    â”‚  - Driver Marker  â”‚                    â”‚
â”‚                    â”‚  - Auto Update    â”‚                    â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Current Settings)

### Ø§Ù„Ø³Ø§Ø¦Ù‚ (Driver)
- **Distance Threshold**: 50 Ù…ØªØ±
- **Update Frequency**: Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø±ÙƒØ© Ø£ÙƒØ«Ø± Ù…Ù† 50 Ù…ØªØ±
- **Data Sent**: `latitude`, `longitude`, `heading`, `speed`, `timestamp`

### Ø§Ù„Ø¹Ù…ÙŠÙ„ (Customer)
- **Polling Interval**: 10 Ø«ÙˆØ§Ù†ÙŠ
- **Update Method**: HTTP GET Request
- **Display**: Google Maps Ù…Ø¹ Marker Ù„Ù„Ø³Ø§Ø¦Ù‚

---

## ğŸš€ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© (Future Improvements)

### 1. **WebSocket Real-time Updates** (Ø§Ù„Ø£ÙØ¶Ù„)
Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Polling ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠØŒ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… WebSocket:

```dart
// WebSocket already supports driverLocationUpdate message type
WebSocketMessageType.driverLocationUpdate
```

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**
- âœ… **Real-time**: ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ (Ø¨Ø¯ÙˆÙ† Ø§Ù†ØªØ¸Ø§Ø± 10 Ø«ÙˆØ§Ù†ÙŠ)
- âœ… **Ø£Ù‚Ù„ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ**: WebSocket connection ÙˆØ§Ø­Ø¯ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† HTTP requests Ù…ØªØ¹Ø¯Ø¯Ø©
- âœ… **Ø£ÙØ¶Ù„ UX**: Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠØ±Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙˆØ±Ø§Ù‹

**Ø§Ù„ØªÙ†ÙÙŠØ°:**
- Backend ÙŠØ±Ø³Ù„ `driverLocationUpdate` message Ø¹Ø¨Ø± WebSocket
- Customer ÙŠØ³ØªÙ…Ø¹ Ù„Ù„Ù€ WebSocket messages
- Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… `driverLocationUpdate` â†’ ÙŠØ­Ø¯Ø« Ø§Ù„Ø®Ø±ÙŠØ·Ø© ÙÙˆØ±Ø§Ù‹

### 2. **Adaptive Polling** (Ø°ÙƒÙŠ)
- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³Ø§Ø¦Ù‚ **Ù‚Ø±ÙŠØ¨** (< 1 km) â†’ Polling ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø³Ø§Ø¦Ù‚ **Ø¨Ø¹ÙŠØ¯** (> 5 km) â†’ Polling ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
- ÙŠÙˆÙØ± Battery Ùˆ Data

### 3. **Background Updates** (ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©)
- Ø­ØªÙ‰ Ù„Ùˆ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø®Ø±Ø¬ Ù…Ù† ØµÙØ­Ø© Tracking
- ÙŠØ±Ø³Ù„ Push Notification Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚

---

## ğŸ“± Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ (Practical Example)

### Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ:
1. **Ø§Ù„Ø³Ø§Ø¦Ù‚** ÙŠØ°Ù‡Ø¨ Online â†’ ÙŠØ¨Ø¯Ø£ ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹
2. **Ø§Ù„Ø³Ø§Ø¦Ù‚** ÙŠØªØ­Ø±Ùƒ 100 Ù…ØªØ± â†’ ÙŠØ±Ø³Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ù€ Backend
3. **Ø§Ù„Ø¹Ù…ÙŠÙ„** ÙŠÙØªØ­ Order Tracking â†’ ÙŠØ¨Ø¯Ø£ Polling ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
4. **Ø§Ù„Ø¹Ù…ÙŠÙ„** ÙŠØ±Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
5. **Ø§Ù„Ø³Ø§Ø¦Ù‚** ÙŠØªØ­Ø±Ùƒ 50 Ù…ØªØ± Ø£Ø®Ø±Ù‰ â†’ ÙŠØ±Ø³Ù„ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯
6. **Ø§Ù„Ø¹Ù…ÙŠÙ„** (Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†ÙŠ) â†’ ÙŠØ·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯
7. **Ø§Ù„Ø¹Ù…ÙŠÙ„** ÙŠØ±Ù‰ Ø§Ù„Ø³Ø§Ø¦Ù‚ ØªØ­Ø±Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©

---

## âœ… Ø§Ù„Ø®Ù„Ø§ØµØ©

**Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:**
- âœ… **Ø§Ù„Ø³Ø§Ø¦Ù‚**: ÙŠØ±Ø³Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒÙ„ 50 Ù…ØªØ±
- âœ… **Ø§Ù„Ø¹Ù…ÙŠÙ„**: ÙŠØ·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ
- âœ… **Ù…ÙˆÙØ± Ù„Ù„Ù€ Battery Ùˆ Data**
- âœ… **Ø¬ÙŠØ¯ Ù„Ù„Ù€ UX**

**Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:**
- ğŸ”„ Ø§Ø³ØªØ®Ø¯Ø§Ù… WebSocket Ù„Ù„Ù€ Real-time updates (Ø§Ù„Ø£ÙØ¶Ù„)
- ğŸ”„ Adaptive Polling Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
- ğŸ”„ Background Updates Ù…Ø¹ Push Notifications

---

**Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² ÙˆÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯!** âœ…

